version: "3"
services:
  db:
     build:
       context: .
       dockerfile: Dockerfile.mongod
     volumes:
       - data:/data/db
     networks:
       - shouldinetwork
     logging:
        driver: awslogs
        options:
          awslogs-region: $AWS_REGION 
          awslogs-group: mongodb 
  app:
      build:
        context: .
        dockerfile: Dockerfile.flask
      depends_on:
        - db
      networks:
        - shouldinetwork
      logging:
        driver: awslogs
        options:
          awslogs-region: $AWS_REGION 
          awslogs-group: flask 
  web:
      build:
        context: .
        dockerfile: Dockerfile.nginx
      depends_on:
        - app 
      ports: 
        - "80:8080"
      networks:
        - shouldinetwork
      logging:
        driver: awslogs
        options:
          awslogs-region: $AWS_REGION 
          awslogs-group: nginx 

volumes:
  data:
networks:
  shouldinetwork:
    driver: bridge
